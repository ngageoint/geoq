(function(a){a.fn.formset=function(b){var l=a.extend({},a.fn.formset.defaults,b);var g=a(this);var d=g.parent();var k=function(p,q,n){var m=new RegExp("("+q+"-(\\d+|__prefix__))");var o=q+"-"+n;if(a(p).prop("for")){a(p).prop("for",a(p).prop("for").replace(m,o))}if(p.id){p.id=p.id.replace(m,o)}if(p.name){p.name=p.name.replace(m,o)}};var e=a("#id_"+l.prefix+"-TOTAL_FORMS").prop("autocomplete","off");var f=parseInt(e.val(),10);var i=a("#id_"+l.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off");var j=i.val()===""||(i.val()-e.val())>0;g.each(function(m){a(this).not("."+l.emptyCssClass).addClass(l.formCssClass)});if(g.length&&j){var h;if(g.prop("tagName")==="TR"){var c=this.eq(-1).children().length;d.append('<tr class="'+l.addCssClass+'"><td colspan="'+c+'"><a href="#">'+l.addText+"</a></tr>");h=d.find("tr:last a")}else{g.filter(":last").after('<div class="'+l.addCssClass+'"><a href="#">'+l.addText+"</a></div>");h=g.filter(":last").next().find("a")}h.click(function(n){n.preventDefault();var m=a("#"+l.prefix+"-empty");var o=m.clone(true);o.removeClass(l.emptyCssClass).addClass(l.formCssClass).attr("id",l.prefix+"-"+f);if(o.is("tr")){o.children(":last").append('<div><a class="'+l.deleteCssClass+'" href="#">'+l.deleteText+"</a></div>")}else{if(o.is("ul")||o.is("ol")){o.append('<li><a class="'+l.deleteCssClass+'" href="#">'+l.deleteText+"</a></li>")}else{o.children(":first").append('<span><a class="'+l.deleteCssClass+'" href="#">'+l.deleteText+"</a></span>")}}o.find("*").each(function(){k(this,l.prefix,e.val())});o.insertBefore(a(m));a(e).val(parseInt(e.val(),10)+1);f+=1;if((i.val()!=="")&&(i.val()-e.val())<=0){h.parent().hide()}o.find("a."+l.deleteCssClass).click(function(t){t.preventDefault();o.remove();f-=1;if(l.removed){l.removed(o)}a(document).trigger("formset:removed",[o,l.prefix]);var p=a("."+l.formCssClass);a("#id_"+l.prefix+"-TOTAL_FORMS").val(p.length);if((i.val()==="")||(i.val()-p.length)>0){h.parent().show()}var q,s;var r=function(){k(this,l.prefix,q)};for(q=0,s=p.length;q<s;q++){k(a(p).get(q),l.prefix,q);a(p.get(q)).find("*").each(r)}});if(l.added){l.added(o)}a(document).trigger("formset:added",[o,l.prefix])})}return this};a.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null};a.fn.tabularFormset=function(d){var c=a(this);var f=function(h){a(c.selector).not(".add-row").removeClass("row1 row2").filter(":even").addClass("row1").end().filter(":odd").addClass("row2")};var b=function(){if(typeof DateTimeShortcuts!=="undefined"){a(".datetimeshortcuts").remove();DateTimeShortcuts.init()}};var e=function(){if(typeof SelectFilter!=="undefined"){a(".selectfilter").each(function(h,j){var i=j.name.split("-");SelectFilter.init(j.id,i[i.length-1],false)});a(".selectfilterstacked").each(function(h,j){var i=j.name.split("-");SelectFilter.init(j.id,i[i.length-1],true)})}};var g=function(h){h.find(".prepopulated_field").each(function(){var l=a(this),j=l.find("input, select, textarea"),i=j.data("dependency_list")||[],k=[];a.each(i,function(m,n){k.push("#"+h.find(".field-"+n).find("input, select, textarea").attr("id"))});if(k.length){j.prepopulate(k,j.attr("maxlength"))}})};c.formset({prefix:d.prefix,addText:d.addText,formCssClass:"dynamic-"+d.prefix,deleteCssClass:"inline-deletelink",deleteText:d.deleteText,emptyCssClass:"empty-form",removed:f,added:function(h){g(h);b();e();f(h)}});return c};a.fn.stackedFormset=function(d){var c=a(this);var e=function(h){a(c.selector).find(".inline_label").each(function(j){var k=j+1;a(this).html(a(this).html().replace(/(#\d+)/g,"#"+k))})};var b=function(){if(typeof DateTimeShortcuts!=="undefined"){a(".datetimeshortcuts").remove();DateTimeShortcuts.init()}};var f=function(){if(typeof SelectFilter!=="undefined"){a(".selectfilter").each(function(h,j){var i=j.name.split("-");SelectFilter.init(j.id,i[i.length-1],false)});a(".selectfilterstacked").each(function(h,j){var i=j.name.split("-");SelectFilter.init(j.id,i[i.length-1],true)})}};var g=function(h){h.find(".prepopulated_field").each(function(){var l=a(this),j=l.find("input, select, textarea"),i=j.data("dependency_list")||[],k=[];a.each(i,function(m,n){k.push("#"+h.find(".form-row .field-"+n).find("input, select, textarea").attr("id"))});if(k.length){j.prepopulate(k,j.attr("maxlength"))}})};c.formset({prefix:d.prefix,addText:d.addText,formCssClass:"dynamic-"+d.prefix,deleteCssClass:"inline-deletelink",deleteText:d.deleteText,emptyCssClass:"empty-form",removed:e,added:function(h){g(h);b();f();e(h)}});return c};a(document).ready(function(){a(".js-inline-admin-formset").each(function(){var c=a(this).data(),b=c.inlineFormset;switch(c.inlineType){case"stacked":a(b.name+"-group .inline-related").stackedFormset(b.options);break;case"tabular":a(b.name+"-group .tabular.inline-related tbody tr").tabularFormset(b.options);break}})})})(django.jQuery);